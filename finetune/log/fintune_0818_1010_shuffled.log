Namespace(adam_epsilon=1e-08, add_task_prefix=False, data_dir='./data', do_eval=True, do_test=True, do_train=True, early_stop_threshold=8, eval_batch_size=16, gradient_accumulation_steps=2, learning_rate=5e-05, load_model_path=None, local_rank=-1, log_dir='./log', max_source_length=512, max_target_length=30, no_cuda=False, num_train_epochs=24, output_dir='./model', seed=42, train_batch_size=32, visible_gpu='0', warm_up_ratio=0.1, weight_decay=0.0)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5-base-multi-sum
model created!
Total 8901 training instances 
***** Running training *****
  Num examples = 8901
  Batch size = 32
  Num epoch = 24

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 0
  eval_ppl = 1.01171
  global_step = 279
  train_loss = 3.3509
  ********************
Previous best ppl:inf
Achieve Best ppl:1.01171
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.63 	 Previous best bleu 0
  ********************
 Achieve Best bleu:15.63
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 1
  eval_ppl = 1.01094
  global_step = 557
  train_loss = 2.8154
  ********************
Previous best ppl:1.01171
Achieve Best ppl:1.01094
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.74 	 Previous best bleu 15.63
  ********************
 Achieve Best bleu:18.74
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 2
  eval_ppl = 1.01042
  global_step = 835
  train_loss = 2.5245
  ********************
Previous best ppl:1.01094
Achieve Best ppl:1.01042
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 21.14 	 Previous best bleu 18.74
  ********************
 Achieve Best bleu:21.14
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 3
  eval_ppl = 1.01021
  global_step = 1113
  train_loss = 2.2211
  ********************
Previous best ppl:1.01042
Achieve Best ppl:1.01021
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 22.3 	 Previous best bleu 21.14
  ********************
 Achieve Best bleu:22.3
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 4
  eval_ppl = 1.01007
  global_step = 1391
  train_loss = 1.9533
  ********************
Previous best ppl:1.01021
Achieve Best ppl:1.01007
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 23.1 	 Previous best bleu 22.3
  ********************
 Achieve Best bleu:23.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 5
  eval_ppl = 1.01013
  global_step = 1669
  train_loss = 1.7202
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 24.91 	 Previous best bleu 23.1
  ********************
 Achieve Best bleu:24.91
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 6
  eval_ppl = 1.01023
  global_step = 1947
  train_loss = 1.5149
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 25.44 	 Previous best bleu 24.91
  ********************
 Achieve Best bleu:25.44
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 7
  eval_ppl = 1.01038
  global_step = 2225
  train_loss = 1.3269
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 25.92 	 Previous best bleu 25.44
  ********************
 Achieve Best bleu:25.92
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 8
  eval_ppl = 1.01056
  global_step = 2503
  train_loss = 1.173
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 26.51 	 Previous best bleu 25.92
  ********************
 Achieve Best bleu:26.51
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 9
  eval_ppl = 1.01068
  global_step = 2781
  train_loss = 1.0338
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 27.18 	 Previous best bleu 26.51
  ********************
 Achieve Best bleu:27.18
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 10
  eval_ppl = 1.01081
  global_step = 3059
  train_loss = 0.9137
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 28.13 	 Previous best bleu 27.18
  ********************
 Achieve Best bleu:28.13
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 11
  eval_ppl = 1.01097
  global_step = 3337
  train_loss = 0.8111
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 28.66 	 Previous best bleu 28.13
  ********************
 Achieve Best bleu:28.66
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 12
  eval_ppl = 1.01111
  global_step = 3615
  train_loss = 0.7281
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 29.46 	 Previous best bleu 28.66
  ********************
 Achieve Best bleu:29.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 13
  eval_ppl = 1.01124
  global_step = 3893
  train_loss = 0.6521
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 29.73 	 Previous best bleu 29.46
  ********************
 Achieve Best bleu:29.73
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 14
  eval_ppl = 1.01136
  global_step = 4171
  train_loss = 0.5899
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 29.97 	 Previous best bleu 29.73
  ********************
 Achieve Best bleu:29.97
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 15
  eval_ppl = 1.01144
  global_step = 4449
  train_loss = 0.5335
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 30.65 	 Previous best bleu 29.97
  ********************
 Achieve Best bleu:30.65
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 16
  eval_ppl = 1.01149
  global_step = 4727
  train_loss = 0.4915
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 30.51 	 Previous best bleu 30.65
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 17
  eval_ppl = 1.01156
  global_step = 5005
  train_loss = 0.4553
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.24 	 Previous best bleu 30.65
  ********************
 Achieve Best bleu:31.24
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 18
  eval_ppl = 1.01162
  global_step = 5283
  train_loss = 0.4217
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.09 	 Previous best bleu 31.24
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 19
  eval_ppl = 1.01169
  global_step = 5561
  train_loss = 0.3991
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.41 	 Previous best bleu 31.24
  ********************
 Achieve Best bleu:31.41
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 20
  eval_ppl = 1.01173
  global_step = 5839
  train_loss = 0.3766
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.47 	 Previous best bleu 31.41
  ********************
 Achieve Best bleu:31.47
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 21
  eval_ppl = 1.01173
  global_step = 6117
  train_loss = 0.3604
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.45 	 Previous best bleu 31.47
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 22
  eval_ppl = 1.01177
  global_step = 6395
  train_loss = 0.3497
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.61 	 Previous best bleu 31.47
  ********************
 Achieve Best bleu:31.61
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 23
  eval_ppl = 1.01178
  global_step = 6673
  train_loss = 0.3411
  ********************
Previous best ppl:1.01007
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 31.58 	 Previous best bleu 31.61
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 30.86 
  ********************
BLEU file: ./data/test_classes.jsonl
  bleu-4 = 32.93 
  ********************
Finish training and take 5h7m
