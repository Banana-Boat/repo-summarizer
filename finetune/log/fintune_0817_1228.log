Namespace(adam_epsilon=1e-08, add_task_prefix=False, data_dir='./data', do_eval=True, do_test=True, do_train=True, early_stop_threshold=8, eval_batch_size=16, gradient_accumulation_steps=2, learning_rate=5e-05, load_model_path=None, local_rank=-1, log_dir='./log', max_source_length=512, max_target_length=30, no_cuda=False, num_train_epochs=24, output_dir='./model', seed=42, train_batch_size=32, visible_gpu='0', warm_up_ratio=0.1, weight_decay=0.0)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5-base-multi-sum
model created!
Total 8901 training instances 
***** Running training *****
  Num examples = 8901
  Batch size = 32
  Num epoch = 24

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 0
  eval_ppl = 1.01101
  global_step = 279
  train_loss = 3.2919
  ********************
Previous best ppl:inf
Achieve Best ppl:1.01101
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 14.64 	 Previous best bleu 0
  ********************
 Achieve Best bleu:14.64
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 1
  eval_ppl = 1.01064
  global_step = 557
  train_loss = 2.7117
  ********************
Previous best ppl:1.01101
Achieve Best ppl:1.01064
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.38 	 Previous best bleu 14.64
  ********************
 Achieve Best bleu:15.38
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 2
  eval_ppl = 1.01056
  global_step = 835
  train_loss = 2.4112
  ********************
Previous best ppl:1.01064
Achieve Best ppl:1.01056
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.1 	 Previous best bleu 15.38
  ********************
 Achieve Best bleu:16.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 3
  eval_ppl = 1.01057
  global_step = 1113
  train_loss = 2.1036
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.73 	 Previous best bleu 16.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 4
  eval_ppl = 1.01081
  global_step = 1391
  train_loss = 1.8336
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.52 	 Previous best bleu 16.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 5
  eval_ppl = 1.01104
  global_step = 1669
  train_loss = 1.5969
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.01 	 Previous best bleu 16.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 6
  eval_ppl = 1.01133
  global_step = 1947
  train_loss = 1.4032
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.05 	 Previous best bleu 16.1
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 7
  eval_ppl = 1.01156
  global_step = 2225
  train_loss = 1.2206
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.63 	 Previous best bleu 16.1
  ********************
 Achieve Best bleu:16.63
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 8
  eval_ppl = 1.0119
  global_step = 2503
  train_loss = 1.0661
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.3 	 Previous best bleu 16.63
  ********************
 Achieve Best bleu:17.3
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 9
  eval_ppl = 1.01211
  global_step = 2781
  train_loss = 0.9363
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.46 	 Previous best bleu 17.3
  ********************
 Achieve Best bleu:17.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 10
  eval_ppl = 1.01233
  global_step = 3059
  train_loss = 0.8289
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.53 	 Previous best bleu 17.46
  ********************
 Achieve Best bleu:17.53
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 11
  eval_ppl = 1.01256
  global_step = 3337
  train_loss = 0.733
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.61 	 Previous best bleu 17.53
  ********************
 Achieve Best bleu:17.61
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 12
  eval_ppl = 1.01278
  global_step = 3615
  train_loss = 0.655
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.21 	 Previous best bleu 17.61
  ********************
 Achieve Best bleu:18.21
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 13
  eval_ppl = 1.01294
  global_step = 3893
  train_loss = 0.5795
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.25 	 Previous best bleu 18.21
  ********************
 Achieve Best bleu:18.25
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 14
  eval_ppl = 1.01306
  global_step = 4171
  train_loss = 0.5234
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.55 	 Previous best bleu 18.25
  ********************
 Achieve Best bleu:18.55
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 15
  eval_ppl = 1.01324
  global_step = 4449
  train_loss = 0.4743
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.91 	 Previous best bleu 18.55
  ********************
 Achieve Best bleu:18.91
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 16
  eval_ppl = 1.01327
  global_step = 4727
  train_loss = 0.4368
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.46 	 Previous best bleu 18.91
  ********************
 Achieve Best bleu:19.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 17
  eval_ppl = 1.01341
  global_step = 5005
  train_loss = 0.3976
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.84 	 Previous best bleu 19.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 18
  eval_ppl = 1.01352
  global_step = 5283
  train_loss = 0.3692
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.99 	 Previous best bleu 19.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 19
  eval_ppl = 1.0136
  global_step = 5561
  train_loss = 0.3468
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.29 	 Previous best bleu 19.46
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 20
  eval_ppl = 1.01363
  global_step = 5839
  train_loss = 0.3276
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.51 	 Previous best bleu 19.46
  ********************
 Achieve Best bleu:19.51
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 21
  eval_ppl = 1.0137
  global_step = 6117
  train_loss = 0.3107
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.26 	 Previous best bleu 19.51
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 22
  eval_ppl = 1.01373
  global_step = 6395
  train_loss = 0.3004
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.31 	 Previous best bleu 19.51
  ********************

***** Running evaluation *****
  Num examples = 2967
  Batch size = 16
  epoch = 23
  eval_ppl = 1.01374
  global_step = 6673
  train_loss = 0.2943
  ********************
Previous best ppl:1.01056
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.37 	 Previous best bleu 19.51
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 19.68 
  ********************
BLEU file: ./data/test_classes.jsonl
  bleu-4 = 17.06 
  ********************
Finish training and take 5h39m
