Namespace(adam_epsilon=1e-08, add_task_prefix=False, data_dir='./data', do_eval=True, do_test=True, do_train=True, early_stop_threshold=8, eval_batch_size=20, gradient_accumulation_steps=2, learning_rate=5e-05, load_model_path=None, local_rank=-1, log_dir='./log', max_source_length=512, max_target_length=30, no_cuda=False, num_train_epochs=24, output_dir='./model', seed=42, train_batch_size=40, visible_gpu='0', warm_up_ratio=0.1, weight_decay=0.0)
Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, model_name: Salesforce/codet5-base-multi-sum
model created!
Total 7296 training instances 
***** Running training *****
  Num examples = 7296
  Batch size = 40
  Num epoch = 24

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 0
  eval_ppl = 1.00836
  global_step = 183
  train_loss = 3.7945
  ********************
Previous best ppl:inf
Achieve Best ppl:1.00836
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 14.92 	 Previous best bleu 0
  ********************
 Achieve Best bleu:14.92
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 1
  eval_ppl = 1.00803
  global_step = 365
  train_loss = 3.2304
  ********************
Previous best ppl:1.00836
Achieve Best ppl:1.00803
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.19 	 Previous best bleu 14.92
  ********************
 Achieve Best bleu:15.19
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 2
  eval_ppl = 1.00787
  global_step = 547
  train_loss = 2.9435
  ********************
Previous best ppl:1.00803
Achieve Best ppl:1.00787
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.67 	 Previous best bleu 15.19
  ********************
 Achieve Best bleu:15.67
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 3
  eval_ppl = 1.00783
  global_step = 729
  train_loss = 2.6792
  ********************
Previous best ppl:1.00787
Achieve Best ppl:1.00783
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 15.96 	 Previous best bleu 15.67
  ********************
 Achieve Best bleu:15.96
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 4
  eval_ppl = 1.0079
  global_step = 911
  train_loss = 2.4624
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.44 	 Previous best bleu 15.96
  ********************
 Achieve Best bleu:16.44
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 5
  eval_ppl = 1.00799
  global_step = 1093
  train_loss = 2.2656
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.67 	 Previous best bleu 16.44
  ********************
 Achieve Best bleu:16.67
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 6
  eval_ppl = 1.00808
  global_step = 1275
  train_loss = 2.1004
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.43 	 Previous best bleu 16.67
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 7
  eval_ppl = 1.00827
  global_step = 1457
  train_loss = 1.9319
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.48 	 Previous best bleu 16.67
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 8
  eval_ppl = 1.0084
  global_step = 1639
  train_loss = 1.7919
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.94 	 Previous best bleu 16.67
  ********************
 Achieve Best bleu:16.94
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 9
  eval_ppl = 1.00855
  global_step = 1821
  train_loss = 1.6719
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.75 	 Previous best bleu 16.94
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 10
  eval_ppl = 1.00867
  global_step = 2003
  train_loss = 1.5633
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 16.98 	 Previous best bleu 16.94
  ********************
 Achieve Best bleu:16.98
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 11
  eval_ppl = 1.00878
  global_step = 2185
  train_loss = 1.459
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.31 	 Previous best bleu 16.98
  ********************
 Achieve Best bleu:17.31
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 12
  eval_ppl = 1.0089
  global_step = 2367
  train_loss = 1.3753
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.8 	 Previous best bleu 17.31
  ********************
 Achieve Best bleu:17.8
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 13
  eval_ppl = 1.00898
  global_step = 2549
  train_loss = 1.2889
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.78 	 Previous best bleu 17.8
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 14
  eval_ppl = 1.00905
  global_step = 2731
  train_loss = 1.2212
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 17.95 	 Previous best bleu 17.8
  ********************
 Achieve Best bleu:17.95
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 15
  eval_ppl = 1.00916
  global_step = 2913
  train_loss = 1.1675
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.25 	 Previous best bleu 17.95
  ********************
 Achieve Best bleu:18.25
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 16
  eval_ppl = 1.00923
  global_step = 3095
  train_loss = 1.1178
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.0 	 Previous best bleu 18.25
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 17
  eval_ppl = 1.0093
  global_step = 3277
  train_loss = 1.0654
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.08 	 Previous best bleu 18.25
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 18
  eval_ppl = 1.00929
  global_step = 3459
  train_loss = 1.0265
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.42 	 Previous best bleu 18.25
  ********************
 Achieve Best bleu:18.42
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 19
  eval_ppl = 1.00937
  global_step = 3641
  train_loss = 0.9932
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.36 	 Previous best bleu 18.42
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 20
  eval_ppl = 1.0094
  global_step = 3823
  train_loss = 0.9719
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.17 	 Previous best bleu 18.42
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 21
  eval_ppl = 1.00943
  global_step = 4005
  train_loss = 0.9501
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.29 	 Previous best bleu 18.42
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 22
  eval_ppl = 1.00945
  global_step = 4187
  train_loss = 0.9367
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.37 	 Previous best bleu 18.42
  ********************

***** Running evaluation *****
  Num examples = 2432
  Batch size = 20
  epoch = 23
  eval_ppl = 1.00946
  global_step = 4369
  train_loss = 0.9278
  ********************
Previous best ppl:1.00783
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.42 	 Previous best bleu 18.42
  ********************
BLEU file: ./data/valid_classes.jsonl
  bleu-4 = 18.52 
  ********************
BLEU file: ./data/test_classes.jsonl
  bleu-4 = 15.62 
  ********************
Finish training and take 2h32m
